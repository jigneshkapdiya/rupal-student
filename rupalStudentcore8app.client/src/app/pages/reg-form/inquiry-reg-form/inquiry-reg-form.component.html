<div class="card">
  <div class="card-content">
    <div class="card-body">
      <!-- Search and Filter Section -->
      <div class="row mb-3">
        <div class="col-md-4">
          <label for="searchText" class="form-label">Search</label>
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text"><i class="fas fa-search"></i></span>
            </div>
            <input type="text" id="searchText" class="form-control" placeholder="Search by name, form number ..." [(ngModel)]="searchText" (input)="onSearchChange()">
            <div class="input-group-append" *ngIf="searchText">
              <button class="btn btn-outline-secondary" type="button" (click)="clearSearch()">
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <label for="status" class="form-label">Status</label>
          <ng-select id="status" [items]="statusList" bindLabel="name" bindValue="name" placeholder="All Status" [(ngModel)]="selectedStatus" (change)="onStatusChange()"
            [clearable]="true" clearAllText="Clear All">
          </ng-select>
        </div>
      </div>

      <!-- Results Info -->
      <div class="row mb-2" *ngIf="filteredDataList.length !== dataList.length || searchText || selectedStatus">
        <div class="col-12">
          <small class="text-muted">
            <i class="fas fa-info-circle mr-1"></i>
            Showing {{filteredDataList.length}} of {{dataList.length}} records
            <span *ngIf="searchText"> matching "{{searchText}}"</span>
            <span *ngIf="selectedStatus"> with status "{{selectedStatus}}"</span>
          </small>
        </div>
      </div>

      <!-- Make sure this wrapper has horizontal scrolling -->
      <div class="table-responsive">
        <table class="table table-striped table-sm">
          <thead class="text-left">
            <tr>
              <th scope="col">#</th>
              <th scope="col">Date</th>
              <th scope="col">NO.</th>
              <th scope="col">Student Name</th>
              <th scope="col">Father Name</th>
              <th scope="col">Family Name</th>
              <th scope="col">Education</th>
              <th scope="col" class="text-center">Percentage</th>
              <th scope="col" class="text-center">CGPA</th>
              <th scope="col" class="text-center">SGPA</th>
              <th scope="col">Status</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of filteredDataList; let i = index">
              <td>{{i+1}}</td>
              <td>{{item.createdOn | date:'dd/MM/yyyy'}}</td>
              <td>{{item.formNumber}}</td>
              <td>
                {{item.studentNameGu}}
                <div *ngIf="item.studentName" class="text-muted small">
                  {{item.studentName}}
                </div>
              </td>
              <td>
                {{item.fatherNameGu}}
                <div *ngIf="item.fatherName" class="text-muted small">
                  {{item.fatherName}}
                </div>
              </td>
              <td>
                {{item.familyNameGu}}
                <div *ngIf="item.familyName" class="text-muted small">
                  {{item.familyName}}
                </div>
              </td>
              <td data-title="Education">{{item.education}}<span *ngIf="item.semester" class="ml-2"> {{item.semester}}</span>
                <div *ngIf="item.schoolName" class="text-muted small">
                  {{item.schoolName}}
                </div>
              </td>
              <td class="text-center">{{item.percentage | number: '1.2-2'}}</td>
              <td class="text-center">{{item.cgpa | number: '1.2-2'}}</td>
              <td class="text-center">{{item.sgpa | number: '1.2-2'}}</td>
              <td>
                <span [ngClass]="item.status === 'New' ? 'badge badge-primary' : (item.status === 'Rejected' ? 'badge badge-danger' : 'badge badge-success')">
                  {{item.status}}
                </span>
              </td>
            </tr>
            <tr *ngIf="filteredDataList?.length === 0 && dataList?.length > 0">
              <td colspan="11" class="text-center">No records match your search criteria!</td>
            </tr>
            <tr *ngIf="dataList?.length === 0">
              <td colspan="11" class="text-center">No records found!</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>